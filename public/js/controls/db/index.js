// Generated by CoffeeScript 1.6.2
exports.opendb = function(callback) {
  var colors, conf, fb;

  colors = global.controls.lib.colors.init();
  fb = global.controls.lib.fb.init();
  conf = global.dbsettings.connections.fdb;
  return fb.attach({
    host: conf.path.replace(/^(.*?)\:(.*)/i, '$1'),
    database: conf.path.replace(/^(.*?)\:(.*)/i, '$2'),
    user: conf.login,
    password: conf.password
  }, function(err, db) {
    if (err) {
      return console.log('firebird:'.error, err.message.data);
    } else {
      console.log('firebird:'.info, 'connected to database'.data);
      if (callback) {
        return callback(db);
      }
    }
  });
};

exports.disconnect = function(db) {
  return db.detach();
};

exports.query = function(sql, db, callback) {
  var colors;

  colors = global.controls.lib.colors.init();
  return db.query(sql, function(err, result) {
    if (err) {
      return console.log('firebird:'.error, err.message.data);
    } else {
      if (callback) {
        return callback(result);
      }
    }
  });
};

exports.checkError = function(err) {
  var colors;

  colors = global.controls.lib.colors.init();
  if (err) {
    return console.log('firebird:'.error, err.message.data);
  }
};

exports.check = function(tr, callback) {
  var colors;

  colors = global.controls.lib.colors.init();
  return function(err, param) {
    if (!err) {
      if (callback) {
        return callback(err, param);
      }
    } else {
      tr.rollback();
      return console.log('firebird:'.error, err.message.data);
    }
  };
};
