// Generated by CoffeeScript 1.5.0

exports.connect = function(cn, callback) {
  var client, net;
  global.clientAnswer = '';
  net = global.controls.lib.net.init();
  client = net.connect(cn.connect.port, cn.connect.ip);
  return callback(client);
};

exports.getAllMessages = function(client, cn, callback) {
  var colors;
  colors = global.controls.lib.colors.init();
  client.write(cn.connect.login + '\n');
  client.write(cn.connect.password + '\n');
  client.write('en' + '\n');
  client.write(cn.commands.getAllMessages.cmd + '\n');
  client.write('exit' + '\n');
  client.write('exit' + '\n');
  client.on('data', function(data) {
    return global.clientAnswer += data.toString();
  });
  client.on('error', function(err) {
    return console.log('telnet:'.error, err.message.data);
  });
  return client.on('close', function() {
    if (global.clientAnswer !== '') {
      return callback(global.controls.parser.snParseMessages(global.clientAnswer));
    } else {
      return console.log('telnet:'.error, 'data not found'.data);
    }
  });
};

exports.insertMessageIntoBase = function(data, cn, db, callback) {
  return global.controls.db.query(global.controls.db.sms.insertMessage(data, cn), db, function(result) {
    return callback(result);
  });
};
